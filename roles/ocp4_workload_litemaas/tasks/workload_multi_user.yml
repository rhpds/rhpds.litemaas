---
# Multi-user LiteMaaS deployment
# Each user gets an isolated LiteMaaS instance in their own namespace

- name: Display multi-user deployment header
  ansible.builtin.debug:
    msg:
      - "========================================="
      - "Deploying Multi-User LiteMaaS"
      - "========================================="
      - "Number of users: {{ num_users }}"
      - "User prefix: {{ ocp4_workload_litemaas_user_prefix }}"
      - "========================================="

- name: Deploy LiteMaaS instance for each user
  ansible.builtin.include_tasks: workload_multi_user_single.yml
  loop: "{{ range(1, num_users + 1) | list }}"
  loop_control:
    loop_var: user_number

- name: Display multi-user deployment summary
  ansible.builtin.debug:
    msg:
      - "========================================="
      - "Multi-User LiteMaaS Deployment Complete"
      - "========================================="
      - "Total users: {{ num_users }}"
      - "Namespaces created: litemaas-{{ ocp4_workload_litemaas_user_prefix }}1 to litemaas-{{ ocp4_workload_litemaas_user_prefix }}{{ num_users }}"
      - "Each user has isolated: PostgreSQL + LiteLLM ({{ ocp4_workload_litemaas_litellm_replicas }} replicas)"
      - "========================================="
